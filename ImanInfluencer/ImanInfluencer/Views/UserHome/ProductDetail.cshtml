@model Tuple<ImanInfluencer.Models.Product1, IEnumerable<ImanInfluencer.Models.Product1>>

@{
    ViewData["Title"] = "ProductDetail";
    Layout = "~/Views/Shared/_UserLayout.cshtml";
}


<!-- breadcrumb -->
<div class="container">
    <div class="bread-crumb flex-w p-l-25 p-r-15 p-t-30 p-lr-0-lg">
        <a asp-controller="UserHome" asp-action="Index" class="stext-109 cl8 hov-cl1 trans-04">
            Home
            <i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
        </a>

        <a asp-controller="UserHome" asp-action="Shop" class="stext-109 cl8 hov-cl1 trans-04">
            @ViewBag.categoryname
            <i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
        </a>

        <span class="stext-109 cl4">
            @Model.Item1.Name
        </span>
    </div>
</div>


<!-- Product Detail -->
<section class="sec-product-detail bg0 p-t-65 p-b-60">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-lg-7 p-b-30">
                <div class="p-l-25 p-r-30 p-lr-0-lg">
                    <div class="wrap-slick3 flex-sb flex-w">
                        <div class="wrap-slick3-dots"></div>
                        <div class="wrap-slick3-arrows flex-sb-m flex-w"></div>

                        <div class="slick3 gallery-lb">

                            @foreach (var item in Model.Item1.Images)
                            {
                                <div class="item-slick3 slick-slide" data-thumb="">
                                    <div class="wrap-pic-w pos-relative">
                                        <img class="ph" src="~/Images/@item.Imagepath" alt="IMG - PRODUCT">

                                        <a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04" href="~/Images/@item.Imagepath">
                                            <i class="fa fa-expand"></i>
                                        </a>
                                    </div>
                                </div>
                            }


                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4 mt-5 ">
                <div class="card">
                    <div class="card-body">
                        <img src="~/Images/@Model.Item1.User.Imagepath" alt="Alternate Text" style="width: 40%;height: 40%; border-radius: 50%" />
                        <h1 class="h2">Name</h1>
                        <p class="h3 py-2">@Model.Item1.User.Fname @Model.Item1.User.Lname</p>
                        <h1 class="h2">Email</h1>
                        <p class="h3 py-2">@Model.Item1.User.Email</p>
                        <h1 class="h2">Phone</h1>
                        <p class="h3 py-2">@Model.Item1.User.Phone</p>


                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-5 p-b-30">
                <div class="p-r-50 p-t-5 p-lr-0-lg">
                    <h4 class="mtext-105 cl2 js-name-detail p-b-14">
                        @Model.Item1.Name
                    </h4>

                    <span class="mtext-106 cl2">
                        $<span> @Model.Item1.Price</span>+20%tax
                    </span>

                    <p id="desc" class="stext-102 cl3 p-t-23">

                    </p>

                    <!--  -->
                    <div class="p-t-33">

                        <div class="flex-w flex-r-m p-b-10">
                            <div class="size-204 flex-w flex-m respon6-next">


                                <button onclick='addtoCart(@Model.Item1.Id)' class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04 js-addcart-detail">
                                    Add to Cart
                                </button>

                            </div>
                            <div id="resultcart" style="color: green;"></div>

                        </div>
                        <div class="form-group mb-3">
                            <select id="payment" class="form-control" asp-items="ViewBag.Paymentid"></select>
                        </div>
                        <div class="flex-w flex-r-m p-b-10">
                            <div class="size-204 flex-w flex-m respon6-next">


                                <button onclick="buyItem()" class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04 ">
                                    Buy
                                </button>

                            </div>
                            <div id="result" style="color: green;"></div>

                        </div>
                    </div>

                    <!--  -->
                    <div class="flex-w flex-m p-l-100 p-t-40 respon7">
                        <div class="flex-m bor9 p-r-10 m-r-11">
                            <a href="#" class="fs-14 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 js-addwish-detail tooltip100" data-tooltip="Add to Wishlist">
                                <i class="zmdi zmdi-favorite"></i>
                            </a>
                        </div>

                        <a href="#" class="fs-14 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 m-r-8 tooltip100" data-tooltip="Facebook">
                            <i class="fa fa-facebook"></i>
                        </a>

                        <a href="#" class="fs-14 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 m-r-8 tooltip100" data-tooltip="Twitter">
                            <i class="fa fa-twitter"></i>
                        </a>

                        <a href="#" class="fs-14 cl3 hov-cl1 trans-04 lh-10 p-lr-5 p-tb-2 m-r-8 tooltip100" data-tooltip="Google Plus">
                            <i class="fa fa-google-plus"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>




<!-- Related Products -->
<section class="sec-relate-product bg0 p-t-45 p-b-105">
    <div class="container">
        <div class="p-b-45">
            <h3 class="ltext-106 cl5 txt-center">
                Related Products
            </h3>
        </div>

        <div class="wrap-slick2">
            <div class="slick2">

                @foreach (var item in Model.Item2)
                {
                    <div class="item-slick2 p-l-15 p-r-15 p-t-15 p-b-15">
                        <!-- Block2 -->
                        <div class="block2">
                            <div class="block2-pic hov-img0">
                                <img src="~/Images/@item.Images.FirstOrDefault().Imagepath" alt="IMG-PRODUCT">

                                <a onclick='redirect("@item.Id")' class="block2-btn flex-c-m stext-103 cl2 size-102 bg0 bor2 hov-btn1 p-lr-15 trans-04 js-show-modal1">
                                    View
                                </a>
                            </div>

                            <div class="block2-txt flex-w flex-t p-t-14">
                                <div class="block2-txt-child1 flex-col-l ">
                                    <a href="#" class="stext-104 cl4 hov-cl1 trans-04 js-name-b2 p-b-6">
                                        @item.Name
                                    </a>

                                    <span class="stext-105 cl3">
                                        $@item.Price +20%tax
                                    </span>
                                </div>


                            </div>
                        </div>
                    </div>

                }
            </div>
        </div>
    </div>
</section>







<script src="~/asset/vendor/jquery/jquery-3.2.1.min.js"></script>
<script src="~/asset/vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>

<script>

    $(window).on('load', function () {
        let ph = $('.ph');
        let smallpicture = $('.cartitem');

        for (var i = 0; i < smallpicture.length; i++) {
            var temp = $(ph[i]).attr('src');
            $(smallpicture[i]).attr('src', temp);
            console.log("small" + $(smallpicture[i]).attr('src'));
            console.log("ph" + $(ph[i]).attr('src'));

        }
    });








    function addtoCart(parm) {
        var result = document.getElementById("resultcart");

         $.ajax({
            type: "POST",
             url: '@Url.Action("AddtoCart")',
             data: { id: parm },
            dataType: "json",
             success: function (msg) {
                 console.log(msg);
                 if (msg == "1")
                     result.innerHTML = "Your order was submited";
                 else if (msg == "0")
                     result.innerHTML = "already exist in cart";
                 
             },
             error: function (req, status, error) {
                 console.log(req);
                 console.log(status);
                 console.log(error);


             }
         });


    }



    function buyItem() {

        var result = document.getElementById("result");
        var payment = document.getElementById("payment").value;

        $.ajax({
            type: "POST",
            url: '@Url.Action("AddItem")',
            data: { sellerid: "@Model.Item1.Userid", productid: "@Model.Item1.Id", payment: payment },
            dataType: "text",
            success: function (msg) {
            console.log(msg);
            if (msg == "1")
            result.innerHTML = "Your order was submited";
            else if(msg == "0")
            result.innerHTML = "Your alredy made that action ";
            else if (msg == "2")
            result.innerHTML = "You dont have enough money";


            },
            error: function (req, status, error) {
            console.log(msg);
            result.innerHTML = "<span style='color : \"red\";'>Your order was not submited</span>";

            }
            });
    }


    function redirect(parm) {
        window.location.href = "/UserHome/ProductDetail/" + parm;
    }
</script>




